<h1>HogeMint</h1>
<% unless ENV["PRINTER_IS_LIVE"] == "true" %>
  <h3>***Test Mode Engaged***</h3>
<% end %>
<p class="lead">Do you want your one-time newly minted non-fungible token? Add an image below. It will be stamped and added to our repository.
  The certificate of authenticity will be added to the blockchain.</p>
<div id="modal_errors" class="alert alert-danger d-none"><ul></ul></div>
<div id="modal_warnings" class="alert alert-warning d-none"><ul></ul></div>
<%= form_with(model: @item) do |f| %>
  <div class="form-group">
    <div class="form-group row">
      <h4><%= f.label :owner, "Title" %></h4>
      <div class="col-sm-6">
        <%= f.text_field :title, maxlength: 20, class: "form-control", placeholder: "" %>
      </div>
    </div>

    <div class="form-group row my-3">
      <h4><%= f.label :owner, "Flavor Text" %></h4>
      <div class="col-sm-6">
        <%= f.text_area :flavor_text, maxlength: 170, class: "form-control", placeholder: "" %>
      </div>
    </div>

    <h4 class="block-title mb-0 ml-0"><%= f.label :image, "Image" %></h4>

    <img id="img_prev" src="#" alt="" class="img-preview" />
    <div class="col-sm-6 my-1">
      <%= f.file_field :image, class: "form-control", onChange: "readURL(this);" %>
    </div>
  </div>

  <div class="form-group row my-3">
    <h4><%= f.label :owner, "Asset Owner" %></h4>
    <div class="col-sm-6">
      <%= f.text_area :owner, maxlength: 200, class: "form-control", placeholder: "(Paste your address here)" %>
    </div>
  </div>

  <div class="form-group my-3">
    <button type="button" id="sign_message-btn" class="btn btn-secondary">Sign Transaction!</button>
  </div>
  <%= f.hidden_field(:signed_msg) %>
  <%= f.hidden_field(:nonce, value: @nonce) %>
  <div class="actions col-sm-8">
    <%= f.submit "Submit",
                 class: "btn btn-primary",
                 id: "submit-btn",
                 disabled: true,
                 autocomplete: "off" %><span class="text-secondary" id="text-warning"> **You must sign the transaction before submitting your image.</span>
  </div>
<% end %>

<!-- Assume jQuery is loaded -->
<script>
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function (e) {
         $('#img_prev')
           .attr('src', e.target.result);
          };
      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
